
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>Quick Guide to Expansion &#8212; Quant Macro Finance</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/material.css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Uncertain Expansion Methods" href="uncertainexpansion.html" />
    <link rel="prev" title="Quant Macro Finance" href="../intro.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=blue-grey data-md-color-accent=blue>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#discrete_local_approximation/quickguide" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../intro.html" title="Quant Macro Finance"
           class="md-header-nav__button md-logo">
          
              <img src="../_static/mfr.png" height="26"
                   alt="Quant Macro Finance logo">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">Quant Macro Finance</span>
          <span class="md-header-nav__topic"> Quick Guide to Expansion </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
      
  
  <script src="../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../"versions.json"",
        target_loc = "../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../intro.html" class="md-tabs__link">Quant Macro Finance</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../intro.html" title="Quant Macro Finance" class="md-nav__button md-logo">
      
        <img src="../_static/mfr.png" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../intro.html"
       title="Quant Macro Finance">Quant Macro Finance</a>
  </label>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#discrete-local-approximation-quickguide--page-root" class="md-nav__link">Quick Guide to Expansion</a>
        </li>
        <li class="md-nav__item"><a href="#five-minute-guide-to-solving-the-dsge-model-using-the-expansion-suite-a-class-anchor-id-s1-a" class="md-nav__link">1. Five-minute guide to solving the DSGE model using the Expansion Suite <a class="anchor" id="s1"></a></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#equilibrium-condition-function-a-class-anchor-id-s1-1-a" class="md-nav__link">1.1 Equilibrium Condition Function <a class="anchor" id="s1-1"></a></a>
        </li>
        <li class="md-nav__item"><a href="#model-steady-state-function-a-class-anchor-id-s1-2-a" class="md-nav__link">1.2 Model Steady State Function <a class="anchor" id="s1-2"></a></a>
        </li>
        <li class="md-nav__item"><a href="#model-variable-dimension-array-a-class-anchor-id-s1-3-a" class="md-nav__link">1.3 Model Variable Dimension Array <a class="anchor" id="s1-3"></a></a>
        </li>
        <li class="md-nav__item"><a href="#model-parameter-calibration-tuple-a-class-anchor-id-s1-4-a" class="md-nav__link">1.4 Model Parameter Calibration Tuple <a class="anchor" id="s1-4"></a></a>
        </li>
        <li class="md-nav__item"><a href="#log-consumption-growth-function-a-class-anchor-id-s1-5-a" class="md-nav__link">1.5 Log Consumption Growth Function <a class="anchor" id="s1-5"></a></a>
        </li>
        <li class="md-nav__item"><a href="#solve-the-one-capital-adjustment-model-using-the-expansion-suite-a-class-anchor-id-s1-6-a" class="md-nav__link">1.6 Solve the One-Capital Adjustment Model using the Expansion Suite <a class="anchor" id="s1-6"></a></a>
        </li>
        <li class="md-nav__item"><a href="#model-solutions-a-class-anchor-id-s1-7-a" class="md-nav__link">1.7 Model Solutions <a class="anchor" id="s1-7"></a></a>
        </li>
        <li class="md-nav__item"><a href="#approximate-variables-a-class-anchor-id-s1-8-a" class="md-nav__link">1.8 Approximate Variables <a class="anchor" id="s1-8"></a></a>
        </li>
        <li class="md-nav__item"><a href="#model-simulations-a-class-anchor-id-s1-9-a" class="md-nav__link">1.9 Model Simulations <a class="anchor" id="s1-9"></a></a>
        </li>
        <li class="md-nav__item"><a href="#shock-elasticities-and-irf-a-class-anchor-id-s1-10-a" class="md-nav__link">1.10 Shock Elasticities and IRF <a class="anchor" id="s1-10"></a></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#examples-to-use-linquadvar-in-computation-a-class-anchor-id-s2-a" class="md-nav__link">2 Examples to use <code class="docutils literal notranslate"><span class="pre">LinQuadVar</span></code> in Computation <a class="anchor" id="s2"></a></a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#define-a-linquadvar-a-class-anchor-id-s2-1-a" class="md-nav__link">2.1 Define a <code class="docutils literal notranslate"><span class="pre">LinQuadVar</span></code> <a class="anchor" id="s2-1"></a></a>
        </li>
        <li class="md-nav__item"><a href="#linquadvar-operations-a-class-anchor-id-s2-2-a" class="md-nav__link">2.2 <code class="docutils literal notranslate"><span class="pre">LinQuadVar</span></code> Operations <a class="anchor" id="s2-2"></a></a>
        </li>
        <li class="md-nav__item"><a href="#linquadvar-split-and-concat-a-class-anchor-id-s2-3-a" class="md-nav__link">2.3 <code class="docutils literal notranslate"><span class="pre">LinQuadVar</span></code> Split and Concat <a class="anchor" id="s2-3"></a></a>
        </li>
        <li class="md-nav__item"><a href="#evaluate-a-linquadvar-a-class-anchor-id-s2-4-a" class="md-nav__link">2.4 Evaluate a <code class="docutils literal notranslate"><span class="pre">LinQuadVar</span></code> <a class="anchor" id="s2-4"></a></a>
        </li>
        <li class="md-nav__item"><a href="#adjust-conditional-information-time-a-class-anchor-id-s2-5-a" class="md-nav__link">2.5 Adjust Conditional Information Time <a class="anchor" id="s2-5"></a></a>
        </li>
        <li class="md-nav__item"><a href="#compute-the-expectation-of-time-t-1-linquadvar-a-class-anchor-id-s2-6-a" class="md-nav__link">2.6 Compute the Expectation of time <span class="math notranslate nohighlight">\(t+1\)</span> <code class="docutils literal notranslate"><span class="pre">LinQuadVar</span></code> <a class="anchor" id="s2-6"></a></a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../_sources/discrete_local_approximation/quickguide.ipynb">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <p><a href="https://colab.research.google.com/github/lphansen/RiskUncertaintyValue/blob/main/quickguide.ipynb" target="_parent"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg"/></a></p>
<section class="tex2jax_ignore mathjax_ignore" id="quick-guide-to-expansion">
<h1 id="discrete-local-approximation-quickguide--page-root">Quick Guide to Expansion<a class="headerlink" href="#discrete-local-approximation-quickguide--page-root" title="Permalink to this heading">¶</a></h1>
<p><strong>Expansion Suite</strong> is an open source Python toolbox for macro-finance research. It solves the nonlinear DSGE model with recursive utility formulation motivated by robustness or risk concerns based on the small-noise expansion method.</p>
<p>For this notebook</p>
<ul class="simple">
<li><p>Section 1 provides a five-minute guide to solving the DSGE model using the expansion suite, as well as how to</p>
<ul>
<li><p>compute shock elasticities and IRF</p></li>
<li><p>approximate and simulate variables based on model solutions.</p></li>
</ul>
</li>
<li><p>Section 2 provides examples of <code class="docutils literal notranslate"><span class="pre">LinQuadVar</span></code> computations, including</p>
<ul>
<li><p>constructions, operations, and evaluations</p></li>
<li><p>adjusting time periods</p></li>
<li><p>computing expectations</p></li>
</ul>
</li>
</ul>
<p><strong>Table of Contents</strong></p>
<ul class="simple">
<li><p><span class="xref myst">1. Five-minute guide to solving the DSGE model using the Expansion Suite</span></p>
<ul>
<li><p><span class="xref myst">1.1 Equilibrium Condition Function</span></p></li>
<li><p><span class="xref myst">1.2 Model Steady State Function</span></p></li>
<li><p><span class="xref myst">1.3 Model Variable Dimension Array</span></p></li>
<li><p><span class="xref myst">1.4 Model Parameter Calibration Tuple</span></p></li>
<li><p><span class="xref myst">1.5 Log Consumption Growth Function</span></p></li>
<li><p><span class="xref myst">1.6 Solve the BY model using the Expansion Suite</span></p></li>
<li><p><span class="xref myst">1.7 Model Solutions</span></p></li>
<li><p><span class="xref myst">1.8 Approximate Variables</span></p></li>
<li><p><span class="xref myst">1.9 Model Simulations</span></p></li>
<li><p><span class="xref myst">1.10 Shock Elasticities and IRF</span></p></li>
</ul>
</li>
<li><p><span class="xref myst">2. Examples to use <code class="docutils literal notranslate"><span class="pre">LinQuadVar</span></code> in Computation</span></p>
<ul>
<li><p><span class="xref myst">2.1 Define a <code class="docutils literal notranslate"><span class="pre">LinQuadVar</span></code> </span></p></li>
<li><p><span class="xref myst">2.2 <code class="docutils literal notranslate"><span class="pre">LinQuadVar</span></code> Operations</span></p></li>
<li><p><span class="xref myst">2.3 <code class="docutils literal notranslate"><span class="pre">LinQuadVar</span></code> Split and Concat</span></p></li>
<li><p><span class="xref myst">2.4 Evaluate a <code class="docutils literal notranslate"><span class="pre">LinQuadVar</span></code></span></p></li>
<li><p><span class="xref myst">2.5 Adjust Conditional Information Time</span></p></li>
<li><p><span class="xref myst">2.6 Compute the Expectation of time <span class="math notranslate nohighlight">\(t+1\)</span></span></p></li>
</ul>
</li>
</ul>
<p><strong>Definition of input variables for the following functions:</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">Var_t</span></code> : array_like; Vector of jump and state variables in the current period.</p>
<p><code class="docutils literal notranslate"><span class="pre">Var_tp1</span></code> : array_like; Vector of jump and state variables in the next period.</p>
<p><code class="docutils literal notranslate"><span class="pre">W_tp1</span></code> : array_like; Vector of shock variables in the next period.</p>
<p><code class="docutils literal notranslate"><span class="pre">q</span></code> : float; Perturbation parameter.</p>
<p><code class="docutils literal notranslate"><span class="pre">mode</span></code> : string; By default, this function returns the LHS of equation (1) and (2). Set mode to ‘psi1’, ‘psi2’, or ‘phi’ to return the corresponding function in the equilibrium conditions.</p>
<p><code class="docutils literal notranslate"><span class="pre">args</span></code> : tuple of float/ndarray; Preference and model parameters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">workdir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
<span class="o">!</span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/lphansen/RiskUncertaintyValue<span class="w"> </span>
<span class="n">workdir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span> <span class="o">+</span> <span class="s1">'/RiskUncertaintyValue'</span>             
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">workdir</span><span class="o">+</span><span class="s1">'/src'</span><span class="p">)</span>                        
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">autograd.numpy</span> <span class="k">as</span> <span class="nn">anp</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">HTML</span>
<span class="kn">from</span> <span class="nn">BY_example_sol</span> <span class="kn">import</span> <span class="n">disp</span>
<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s2">"&lt;style&gt;.container { width:97% !important; }&lt;/style&gt;"</span><span class="p">))</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">"ignore"</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">lin_quad</span> <span class="kn">import</span> <span class="n">LinQuadVar</span>
<span class="kn">from</span> <span class="nn">lin_quad_util</span> <span class="kn">import</span> <span class="n">E</span><span class="p">,</span> <span class="n">concat</span><span class="p">,</span> <span class="n">next_period</span><span class="p">,</span> <span class="n">cal_E_ww</span><span class="p">,</span> <span class="n">lq_sum</span><span class="p">,</span> <span class="n">N_tilde_measure</span><span class="p">,</span> <span class="n">E_N_tp1</span>
<span class="kn">from</span> <span class="nn">uncertain_expansion</span> <span class="kn">import</span> <span class="n">uncertain_expansion</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>.container { width:97% !important; }</style></div></div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="five-minute-guide-to-solving-the-dsge-model-using-the-expansion-suite-a-class-anchor-id-s1-a">
<h1 id="five-minute-guide-to-solving-the-dsge-model-using-the-expansion-suite-a-class-anchor-id-s1-a">1. Five-minute guide to solving the DSGE model using the Expansion Suite <a class="anchor" id="s1"></a><a class="headerlink" href="#five-minute-guide-to-solving-the-dsge-model-using-the-expansion-suite-a-class-anchor-id-s1-a" title="Permalink to this heading">¶</a></h1>
<p>Suppose we would like to solve an adjustment cost model. Its equilibrium conditions include</p>
<ul class="simple">
<li><p>Three forward-looking conditions</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\frac{C_t}{K_t} + \frac{I_t}{K_t}  &amp;= {\mathbf a}\\
\mathbb{E}\left[\left(\frac{S_{t+1}}{S_t}\right) \frac {MK_{t+1}}{MC_{t+1}} \frac{K_{t+1}}{K_t} \frac{1}{1+\theta_2\left(\frac{I_t}{K_t}\right)} \mid \mathfrak{A}_t\right] - 1  &amp;= 0\\
\mathbb{E}\left[\left(\frac{S_{t+1}}{S_t}\right) \frac {MK_{t+1}}{MC_{t+1}} \frac{K_{t+1}}{K_t} \frac{1
+(\theta_2-1)\frac{I_t}{K_t}}{1+\theta_2\left(\frac{I_t}{K_t}\right)} \mid \mathfrak{A}_t\right] - \frac{MK_t}{MC_t}+{\mathbf a}&amp;= 0
\end{aligned}
\end{split}\]</div>
<ul class="simple">
<li><p>Two state-evolution equations</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\frac{K_{t+1}}{K_t} &amp;=  \left[1 + \theta_2 \left({\frac {I_t} {K_t}}\right) \right]^{\theta_1} \exp( - \alpha_k + Z_t - {\frac 1 2} \mid \sigma_k \mid^2  + \sigma_k\cdot W_{t+1})\\
Z_{t+1} &amp;= {\mathbb A} Z_t + \mathbb{B} W_{t+1}
\end{aligned}
\end{split}\]</div>
<p>where we have</p>
<div class="math notranslate nohighlight">
\[
\begin{aligned}
\frac{S_{t+1}}{S_t}&amp; = \beta \left(\frac{V_{t+1}}{R_t}\right)^{1-\gamma} \left(\frac{V_{t+1}}{R_t}\right)^{\rho-1} \left(\frac{C_{t+1}}{C_t}\right)^{-\rho}
\end{aligned}
\]</div>
<p>The model has one jump variable (In the expansion suite, <span class="math notranslate nohighlight">\(J_t\)</span> is used to represent jump variables):</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\log C_t - \log K_t\)</span> : Log consumption over capital</p></li>
<li><p><span class="math notranslate nohighlight">\(\log I_t - \log K_t\)</span> : Log investment over capital</p></li>
<li><p><span class="math notranslate nohighlight">\(\log MK_t - \log MC_t\)</span> : Log co-state variable</p></li>
</ul>
<p>Two state variables (In the expansion suite, <span class="math notranslate nohighlight">\(X_t\)</span> is used to represent state variables):</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\log K_{t} - \log K_{t-1}\)</span> : Log capital growth process</p></li>
<li><p><span class="math notranslate nohighlight">\(Z_{t}\)</span> : Exogenous state</p></li>
</ul>
<p>The Expansion Suite only takes <strong>five</strong> necessary inputs to solve the DSGE model.</p>
<section id="equilibrium-condition-function-a-class-anchor-id-s1-1-a">
<h2 id="equilibrium-condition-function-a-class-anchor-id-s1-1-a">1.1 Equilibrium Condition Function <a class="anchor" id="s1-1"></a><a class="headerlink" href="#equilibrium-condition-function-a-class-anchor-id-s1-1-a" title="Permalink to this heading">¶</a></h2>
<p>The Equilibrium Condition Function takes the form of the next cell.</p>
<p>Note that:</p>
<ol class="arabic simple">
<li><p>At the beginning of this function, we need to specify the parameters and variables used in the equilibrium conditions.</p>
<ul class="simple">
<li><p>The first components of <code class="docutils literal notranslate"><span class="pre">Var_t</span></code> and <code class="docutils literal notranslate"><span class="pre">Var_tp1</span></code> are fixed as <code class="docutils literal notranslate"><span class="pre">q_t</span></code> or <code class="docutils literal notranslate"><span class="pre">q_tp1</span></code>. (See Exploring Recursive Utility Appendix for details.)</p></li>
<li><p>State variables need to follow jump variables.</p></li>
<li><p>The number of jump variables (except <code class="docutils literal notranslate"><span class="pre">q_t</span></code> and <code class="docutils literal notranslate"><span class="pre">q_tp1</span></code>) should equal the number of forward-looking equilibrium conditions.</p></li>
<li><p>The number of state variables should equal to the number of state evolution equations.</p></li>
</ul>
</li>
<li><p>Then we specify each equilibrium condition using above specified parameter and variables.</p>
<ul class="simple">
<li><p>The algorithm requires us to rewrite the equilibrium conditions in the form as equation (1). We need to find what <code class="docutils literal notranslate"><span class="pre">psi1</span></code> is in our equilibrium conditions, specify what  <code class="docutils literal notranslate"><span class="pre">psi1</span></code> look like, and then return it using <code class="docutils literal notranslate"><span class="pre">psi1</span></code> mode.</p></li>
<li><p>The log change of measure is skipped in the specification of equilibrium conditions.</p></li>
</ul>
</li>
<li><p>By default (without <code class="docutils literal notranslate"><span class="pre">mode</span></code> specification), the function needs to return the LHS of each equilibrium condition before taking expectation.</p></li>
</ol>
<ul class="simple">
<li><p>The state-evolution equations should follow the forward-looking conditions.</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
\tag{1}
\begin{split}
\mathbb{E}[{N_{t+1}^*Q_{t+1}^* \psi_1(X_t, J_t, X_{t+1}, J_{t+1})}|{\mathfrak{A}_t}] - \psi_2(X_t, J_t)  &amp;= 0  \\
\phi\left(X_t, X_{t+1}, J_t, {\sf q}W_{t+1}, {\sf q} \right) &amp;= 0 
\end{split} 
\end{equation}
\end{split}\]</div>
<ul class="simple">
<li><p>In this simple example, we can rewrite the FOC and co-state equation as</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\mathbb{E}\left[ N_{t+1}^*Q_{t+1}^* \beta\left(\frac{C_{t+1}}{C_t}\right)^{-\rho}\frac {MK_{t+1}}{MC_{t+1}} \frac{K_{t+1}}{K_t} \frac{1}{1+\theta_2\left(\frac{I_t}{K_t}\right)} \mid \mathfrak{A}_t\right] - 1  &amp;= 0\\
\mathbb{E}\left[N_{t+1}^*Q_{t+1}^* \beta\left(\frac{C_{t+1}}{C_t}\right)^{-\rho} \frac {MK_{t+1}}{MC_{t+1}} \frac{K_{t+1}}{K_t} \frac{1
+(\theta_2-1)\frac{I_t}{K_t}}{1+\theta_2\left(\frac{I_t}{K_t}\right)} \mid \mathfrak{A}_t\right] - \frac{MK_t}{MC_t}+{\mathbf a}&amp;= 0\\
\end{aligned}
\end{split}\]</div>
<ul class="simple">
<li><p>where <code class="docutils literal notranslate"><span class="pre">psi1</span></code> will be a three dimensional array</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\psi_1 = 
\begin{bmatrix}
0\\ 
\beta\left(\frac{C_{t+1}}{C_t}\right)^{-\rho}\frac {MK_{t+1}}{MC_{t+1}} \frac{K_{t+1}}{K_t} \frac{1}{1+\theta_2\left(\frac{I_t}{K_t}\right)}\\
\beta\left(\frac{C_{t+1}}{C_t}\right)^{-\rho} \frac {MK_{t+1}}{MC_{t+1}} \frac{K_{t+1}}{K_t} \frac{1
+(\theta_2-1)\frac{I_t}{K_t}}{1+\theta_2\left(\frac{I_t}{K_t}\right)}\end{bmatrix}
\end{split}\]</div>
<ul class="simple">
<li><p>the <code class="docutils literal notranslate"><span class="pre">psi2</span></code> will also be a three dimensional array</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\psi_2 = 
\begin{bmatrix}
\frac{C_t}{K_t} + \frac{I_t}{K_t} - {\mathbf a}\\
1\\
\frac{MK_t}{MC_t}-{\mathbf a}
\end{bmatrix}
\end{split}\]</div>
<ul class="simple">
<li><p>the <code class="docutils literal notranslate"><span class="pre">phi</span></code> will be a two dimensional array</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\phi=\begin{bmatrix} 
&amp;\frac{K_{t+1}}{K_t} - \left[1 + \theta_2 \left({\frac {I_t} {K_t}}\right) \right]^{\theta_1} \exp( - \alpha_k + Z_t - {\frac 1 2} \mid \sigma_k \mid^2  + \sigma_k\cdot W_{t+1})\\
&amp;Z_{t+1} - {\mathbb A} Z_t + \mathbb{B} W_{t+1}
\end{bmatrix}\end{split}\]</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">eq_ac</span><span class="p">(</span><span class="n">Var_t</span><span class="p">,</span> <span class="n">Var_tp1</span><span class="p">,</span> <span class="n">W_tp1</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    
    <span class="c1"># Unpack model parameters</span>
    <span class="n">γ</span><span class="p">,</span> <span class="n">β</span><span class="p">,</span> <span class="n">ρ</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">θ_1</span><span class="p">,</span> <span class="n">θ_2</span><span class="p">,</span> <span class="n">α_k</span><span class="p">,</span> <span class="n">σ_k</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">args</span>

    <span class="c1"># Unpack model variables</span>
    <span class="n">q_t</span><span class="p">,</span> <span class="n">cmk_t</span><span class="p">,</span> <span class="n">imk_t</span><span class="p">,</span> <span class="n">mkmc_t</span><span class="p">,</span> <span class="n">Z_t</span><span class="p">,</span> <span class="n">gk_t</span> <span class="o">=</span> <span class="n">Var_t</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
    <span class="n">q_tp1</span><span class="p">,</span> <span class="n">cmk_tp1</span><span class="p">,</span> <span class="n">imk_tp1</span><span class="p">,</span> <span class="n">mkmc_tp1</span><span class="p">,</span> <span class="n">Z_tp1</span><span class="p">,</span> <span class="n">gk_tp1</span> <span class="o">=</span> <span class="n">Var_tp1</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

    <span class="c1"># Intermedite varibles that facilitates computation</span>
    <span class="n">sdf_ex</span> <span class="o">=</span> <span class="n">anp</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">β</span><span class="p">)</span> <span class="o">-</span> <span class="n">ρ</span><span class="o">*</span><span class="p">(</span><span class="n">cmk_tp1</span><span class="o">+</span><span class="n">gk_tp1</span><span class="o">-</span><span class="n">cmk_t</span><span class="p">)</span>
    <span class="n">g_dep</span> <span class="o">=</span> <span class="o">-</span><span class="n">α_k</span> <span class="o">+</span> <span class="n">Z_t</span> <span class="o">+</span> <span class="n">σ_k</span><span class="o">.</span><span class="n">T</span><span class="nd">@W_tp1</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span><span class="p">(</span><span class="n">σ_k</span><span class="o">.</span><span class="n">T</span><span class="nd">@σ_k</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    
    <span class="c1">## Forward-looking conditions</span>
    <span class="n">psi1_1</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="n">psi1_2</span> <span class="o">=</span> <span class="n">anp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">sdf_ex</span> <span class="o">+</span> <span class="n">mkmc_tp1</span> <span class="o">+</span> <span class="n">gk_tp1</span> <span class="o">-</span> <span class="n">anp</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">θ_2</span> <span class="o">*</span> <span class="n">anp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">imk_t</span><span class="p">)))</span>
    <span class="n">psi1_3</span> <span class="o">=</span> <span class="n">anp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">sdf_ex</span> <span class="o">+</span> <span class="n">mkmc_tp1</span> <span class="o">+</span> <span class="n">gk_tp1</span> <span class="o">+</span> <span class="n">anp</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="p">(</span><span class="n">θ_2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">anp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">imk_t</span><span class="p">))</span> <span class="o">-</span> <span class="n">anp</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span> <span class="n">θ_2</span><span class="o">*</span><span class="n">anp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">imk_t</span><span class="p">)))</span>

    <span class="n">psi2_1</span> <span class="o">=</span> <span class="o">-</span><span class="n">a</span> <span class="o">+</span> <span class="n">anp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">cmk_t</span><span class="p">)</span> <span class="o">+</span> <span class="n">anp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">imk_t</span><span class="p">)</span>
    <span class="n">psi2_2</span> <span class="o">=</span> <span class="mf">1.</span>
    <span class="n">psi2_3</span> <span class="o">=</span> <span class="n">anp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">mkmc_t</span><span class="p">)</span> <span class="o">-</span> <span class="n">a</span>

    <span class="c1"># State evoluion processes</span>
    <span class="n">phi_1</span> <span class="o">=</span> <span class="n">Z_tp1</span> <span class="o">-</span> <span class="n">A</span><span class="o">*</span><span class="n">Z_t</span> <span class="o">-</span> <span class="n">B</span><span class="nd">@W_tp1</span>
    <span class="n">phi_2</span> <span class="o">=</span> <span class="n">gk_tp1</span> <span class="o">-</span> <span class="n">θ_1</span> <span class="o">*</span> <span class="n">anp</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">θ_2</span><span class="o">*</span><span class="n">anp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">imk_t</span><span class="p">))</span> <span class="o">-</span> <span class="n">g_dep</span>
    
    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">'psi1'</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">psi1_1</span><span class="p">,</span> <span class="n">psi1_2</span><span class="p">,</span> <span class="n">psi1_3</span><span class="p">])</span>
    
    <span class="k">return</span> <span class="n">anp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
        <span class="n">psi1_1</span> <span class="o">*</span> <span class="n">anp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">q_tp1</span><span class="p">)</span> <span class="o">-</span> <span class="n">psi2_1</span><span class="p">,</span>
        <span class="n">psi1_2</span> <span class="o">*</span> <span class="n">anp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">q_tp1</span><span class="p">)</span> <span class="o">-</span> <span class="n">psi2_2</span><span class="p">,</span>
        <span class="n">psi1_3</span> <span class="o">*</span> <span class="n">anp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">q_tp1</span><span class="p">)</span> <span class="o">-</span> <span class="n">psi2_3</span><span class="p">,</span>
        <span class="n">phi_1</span><span class="p">,</span> <span class="n">phi_2</span><span class="p">])</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="model-steady-state-function-a-class-anchor-id-s1-2-a">
<h2 id="model-steady-state-function-a-class-anchor-id-s1-2-a">1.2 Model Steady State Function <a class="anchor" id="s1-2"></a><a class="headerlink" href="#model-steady-state-function-a-class-anchor-id-s1-2-a" title="Permalink to this heading">¶</a></h2>
<p>This function takes model parameters as input and outputs the steady states for each variable following the variable order specified in <code class="docutils literal notranslate"><span class="pre">Var_t</span></code> and <code class="docutils literal notranslate"><span class="pre">Var_tp1</span></code>.</p>
<ul class="simple">
<li><p>The first one will always be 0, since the steady state of <code class="docutils literal notranslate"><span class="pre">q_t</span></code> is 0.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">ss_ac</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>

    <span class="n">γ</span><span class="p">,</span> <span class="n">β</span><span class="p">,</span> <span class="n">ρ</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">θ_1</span><span class="p">,</span> <span class="n">θ_2</span><span class="p">,</span> <span class="n">α_k</span><span class="p">,</span> <span class="n">σ_k</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">args</span>

    <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">imk</span><span class="p">):</span>
        <span class="n">g_k</span> <span class="o">=</span> <span class="n">θ_1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span> <span class="n">θ_2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">imk</span><span class="p">))</span> <span class="o">-</span> <span class="n">α_k</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span><span class="p">(</span><span class="n">σ_k</span><span class="o">.</span><span class="n">T</span><span class="nd">@σ_k</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        <span class="n">sdf_ex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">β</span><span class="p">)</span> <span class="o">-</span> <span class="n">ρ</span><span class="o">*</span><span class="n">g_k</span>
        <span class="n">g_dep</span> <span class="o">=</span> <span class="o">-</span><span class="n">α_k</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span><span class="p">(</span><span class="n">σ_k</span><span class="o">.</span><span class="n">T</span><span class="nd">@σ_k</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        <span class="n">mkmc</span> <span class="o">=</span> <span class="n">anp</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="n">anp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">sdf_ex</span>  <span class="o">+</span> <span class="n">g_k</span> <span class="o">-</span> <span class="n">anp</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">θ_2</span> <span class="o">*</span> <span class="n">anp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">imk</span><span class="p">)))</span> <span class="p">)</span>
        <span class="k">return</span> <span class="n">anp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">sdf_ex</span> <span class="o">+</span> <span class="n">mkmc</span> <span class="o">+</span> <span class="n">g_k</span> <span class="o">+</span> <span class="n">anp</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="p">(</span><span class="n">θ_2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">anp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">imk</span><span class="p">))</span> <span class="o">-</span> <span class="n">anp</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span> <span class="n">θ_2</span><span class="o">*</span><span class="n">anp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">imk</span><span class="p">)))</span> <span class="o">-</span> <span class="n">anp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">mkmc</span><span class="p">)</span> <span class="o">+</span> <span class="n">a</span>

    <span class="n">imk</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">bisect</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="o">-</span><span class="mi">40</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
    <span class="n">cmk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">imk</span><span class="p">))</span>
    <span class="n">g_k</span> <span class="o">=</span> <span class="n">θ_1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">θ_2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">imk</span><span class="p">))</span> <span class="o">-</span> <span class="n">α_k</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span><span class="p">(</span><span class="n">σ_k</span><span class="o">.</span><span class="n">T</span><span class="nd">@σ_k</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    <span class="n">sdf_ex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">β</span><span class="p">)</span> <span class="o">-</span> <span class="n">ρ</span><span class="o">*</span><span class="n">g_k</span>
    <span class="n">g_dep</span> <span class="o">=</span> <span class="o">-</span> <span class="n">α_k</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span><span class="p">(</span><span class="n">σ_k</span><span class="o">.</span><span class="n">T</span><span class="nd">@σ_k</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    <span class="n">mkmc</span> <span class="o">=</span> <span class="n">anp</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="n">anp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">sdf_ex</span>  <span class="o">+</span> <span class="n">g_k</span> <span class="o">-</span> <span class="n">anp</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">θ_2</span> <span class="o">*</span> <span class="n">anp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">imk</span><span class="p">)))</span> <span class="p">)</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="n">cmk</span><span class="p">,</span> <span class="n">imk</span><span class="p">,</span> <span class="n">mkmc</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">g_k</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="model-variable-dimension-array-a-class-anchor-id-s1-3-a">
<h2 id="model-variable-dimension-array-a-class-anchor-id-s1-3-a">1.3 Model Variable Dimension Array <a class="anchor" id="s1-3"></a><a class="headerlink" href="#model-variable-dimension-array-a-class-anchor-id-s1-3-a" title="Permalink to this heading">¶</a></h2>
<p>Specify a simple numpy array for <code class="docutils literal notranslate"><span class="pre">(n_J,</span> <span class="pre">n_X,</span> <span class="pre">n_W)</span></code>. The dimensions for jump variables, state variables, and shock variables in the model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">var_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="model-parameter-calibration-tuple-a-class-anchor-id-s1-4-a">
<h2 id="model-parameter-calibration-tuple-a-class-anchor-id-s1-4-a">1.4 Model Parameter Calibration Tuple <a class="anchor" id="s1-4"></a><a class="headerlink" href="#model-parameter-calibration-tuple-a-class-anchor-id-s1-4-a" title="Permalink to this heading">¶</a></h2>
<p>Specify all the model parameters using a Python tuple. The first three are fixed recursive utility parameters, γ, β, ρ.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">γ</span> <span class="o">=</span> <span class="mf">10.</span>
<span class="n">ρ</span> <span class="o">=</span> <span class="mf">4.</span><span class="o">/</span><span class="mi">3</span>
<span class="n">β</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.0025</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">0.0288</span>
<span class="n">θ_2</span> <span class="o">=</span> <span class="mf">88.</span>
<span class="n">θ_1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">θ_2</span> 
<span class="n">α_k</span> <span class="o">=</span> <span class="mf">0.0088</span>
<span class="n">σ_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.477</span><span class="p">],[</span><span class="mi">0</span><span class="p">]])</span> <span class="o">*</span> <span class="mf">0.01</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.014</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.011</span><span class="p">,</span><span class="mf">0.025</span><span class="p">]])</span> <span class="o">*</span> <span class="mf">0.01</span>

<span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">γ</span><span class="p">,</span> <span class="n">β</span><span class="p">,</span> <span class="n">ρ</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">θ_1</span><span class="p">,</span> <span class="n">θ_2</span><span class="p">,</span> <span class="n">α_k</span><span class="p">,</span> <span class="n">σ_k</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="log-consumption-growth-function-a-class-anchor-id-s1-5-a">
<h2 id="log-consumption-growth-function-a-class-anchor-id-s1-5-a">1.5 Log Consumption Growth Function <a class="anchor" id="s1-5"></a><a class="headerlink" href="#log-consumption-growth-function-a-class-anchor-id-s1-5-a" title="Permalink to this heading">¶</a></h2>
<p>The expansion suite deals with the recursive utility in equation (2). We need to specify how to compute the log-growth of consumption using the defined variables <code class="docutils literal notranslate"><span class="pre">Var_t</span></code> and <code class="docutils literal notranslate"><span class="pre">Var_tp1</span></code> in the equilibrium conditions.</p>
<ul class="simple">
<li><p>For some models with habits, <span class="math notranslate nohighlight">\(C_t\)</span> is replaced with <span class="math notranslate nohighlight">\(U_t\)</span>, then we need to specify the log growth process for <span class="math notranslate nohighlight">\(U_t\)</span> correspondingly.</p></li>
<li><p>For some models with preference shocks, <span class="math notranslate nohighlight">\(C_t = \lambda_t \tilde{C}_t\)</span>, we need to specify the log growth process for <span class="math notranslate nohighlight">\(\lambda_t \tilde{C}_t\)</span>.</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
V_t=\left[(1-\beta)\left(C_t\right)^{1-\rho}+\beta\left(R_t\right)^{1-\rho}\right]^{\frac{1}{1-\rho}}\tag{2}
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">gc_ac</span><span class="p">(</span><span class="n">Var_t</span><span class="p">,</span> <span class="n">Var_tp1</span><span class="p">,</span> <span class="n">W_tp1</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    
    <span class="c1"># Unpack model parameters</span>
    <span class="n">γ</span><span class="p">,</span> <span class="n">β</span><span class="p">,</span> <span class="n">ρ</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">θ_1</span><span class="p">,</span> <span class="n">θ_2</span><span class="p">,</span> <span class="n">α_k</span><span class="p">,</span> <span class="n">σ_k</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">args</span>

    <span class="c1"># Unpack model variables (q_t and q_tp1 should be the first variables)</span>
    <span class="n">q_t</span><span class="p">,</span> <span class="n">cmk_t</span><span class="p">,</span> <span class="n">imk_t</span><span class="p">,</span> <span class="n">mkmc_t</span><span class="p">,</span> <span class="n">Z_t</span><span class="p">,</span> <span class="n">gk_t</span> <span class="o">=</span> <span class="n">Var_t</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
    <span class="n">q_tp1</span><span class="p">,</span> <span class="n">cmk_tp1</span><span class="p">,</span> <span class="n">imk_tp1</span><span class="p">,</span> <span class="n">mkmc_tp1</span><span class="p">,</span> <span class="n">Z_tp1</span><span class="p">,</span> <span class="n">gk_tp1</span> <span class="o">=</span> <span class="n">Var_tp1</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

    <span class="c1"># Compute log consumption growth</span>
    <span class="n">gc_tp1</span> <span class="o">=</span> <span class="n">cmk_tp1</span> <span class="o">+</span> <span class="n">gk_tp1</span> <span class="o">-</span> <span class="n">cmk_t</span>
    
    <span class="k">return</span> <span class="n">gc_tp1</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="solve-the-one-capital-adjustment-model-using-the-expansion-suite-a-class-anchor-id-s1-6-a">
<h2 id="solve-the-one-capital-adjustment-model-using-the-expansion-suite-a-class-anchor-id-s1-6-a">1.6 Solve the One-Capital Adjustment Model using the Expansion Suite <a class="anchor" id="s1-6"></a><a class="headerlink" href="#solve-the-one-capital-adjustment-model-using-the-expansion-suite-a-class-anchor-id-s1-6-a" title="Permalink to this heading">¶</a></h2>
<p>The expansion suite takes the above five necessary inputs to solve a model. The solution is stored in a class named <code class="docutils literal notranslate"><span class="pre">ModelSolution</span></code>(Please refer to uncertainexpansion.ipynb for details.) under the Linear Quadratic Framework. The computation of the framework is built on a <code class="docutils literal notranslate"><span class="pre">LinQuadVar</span></code> class.</p>
<p>See <a class="reference external" href="https://github.com/lphansen/RiskUncertaintyValue/blob/main/src/uncertain_expansion.py">src/uncertain_expansion.py</a> for source code of expansion suite.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solve the One-Capital Adjustment Model</span>
<span class="n">eq</span> <span class="o">=</span> <span class="n">eq_ac</span>
<span class="n">ss</span> <span class="o">=</span> <span class="n">ss_ac</span>
<span class="n">gc</span> <span class="o">=</span> <span class="n">gc_ac</span>
<span class="n">var_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">γ</span><span class="p">,</span> <span class="n">β</span><span class="p">,</span> <span class="n">ρ</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">θ_1</span><span class="p">,</span> <span class="n">θ_2</span><span class="p">,</span> <span class="n">α_k</span><span class="p">,</span> <span class="n">σ_k</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="n">approach</span> <span class="o">=</span> <span class="s1">'1'</span> <span class="c1"># See Exploring Recursive Utility Appendix for difference about approach '1' and '2'</span>
<span class="n">ModelSol</span> <span class="o">=</span> <span class="n">uncertain_expansion</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">var_shape</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">gc</span><span class="p">,</span> <span class="n">approach</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteration 1: error = 1.13750867
Iteration 2: error = 4.97379915e-14
</pre></div>
</div>
</div>
</div>
</section>
<section id="model-solutions-a-class-anchor-id-s1-7-a">
<h2 id="model-solutions-a-class-anchor-id-s1-7-a">1.7 Model Solutions <a class="anchor" id="s1-7"></a><a class="headerlink" href="#model-solutions-a-class-anchor-id-s1-7-a" title="Permalink to this heading">¶</a></h2>
<p>Below cells display analytical forms of the approximation results for jump variables and state variables. These variables are all stored as <code class="docutils literal notranslate"><span class="pre">LinQuadVar</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Log consumption over capital approximation results, shown in the LinQuadVar coefficients form</span>
<span class="n">ModelSol</span><span class="p">[</span><span class="s1">'JX1_t'</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">coeffs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{'x': array([[11.87510894, -0.        ]]), 'c': array([[-0.09142881]])}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Log consumption over capital approximation results, shown in the Latex analytical form</span>
<span class="n">disp</span><span class="p">(</span><span class="n">ModelSol</span><span class="p">[</span><span class="s1">'JX_t'</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="s1">'</span><span class="se">\\</span><span class="s1">log</span><span class="se">\\</span><span class="s1">frac</span><span class="si">{C_t}{K_t}</span><span class="s1">'</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \log\frac{C_t}{K_t}=-4.793+\begin{bmatrix}12.45&amp;-2.248e-19\end{bmatrix}X_t^1+\begin{bmatrix}5.938&amp;-1.1e-19\end{bmatrix}X_t^2+X^{1T}_{t}\begin{bmatrix}-26.3&amp;2.438e-18\\-1.82e-18&amp;-4.52e-38\end{bmatrix}X^1_{t}\end{split}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Log consumption over capital zeroth order approximation results</span>
<span class="n">disp</span><span class="p">(</span><span class="n">ModelSol</span><span class="p">[</span><span class="s1">'J0_t'</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="s1">'</span><span class="se">\\</span><span class="s1">log</span><span class="se">\\</span><span class="s1">frac{C_t^0}{K_t^0}'</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \log\frac{C_t^0}{K_t^0}=-4.691\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Log consumption over capital first order approximation results</span>
<span class="n">disp</span><span class="p">(</span><span class="n">ModelSol</span><span class="p">[</span><span class="s1">'J1_t'</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="s1">'</span><span class="se">\\</span><span class="s1">log</span><span class="se">\\</span><span class="s1">frac{C_t^1}{K_t^1}'</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \log\frac{C_t^1}{K_t^1}=-0.09143+\begin{bmatrix}11.88&amp;-2.2e-19\end{bmatrix}X_t^1\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Log consumption over capital second order approximation results</span>
<span class="n">disp</span><span class="p">(</span><span class="n">ModelSol</span><span class="p">[</span><span class="s1">'J2_t'</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="s1">'</span><span class="se">\\</span><span class="s1">log</span><span class="se">\\</span><span class="s1">frac{C_t^2}{K_t^2}'</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \log\frac{C_t^2}{K_t^2}=-0.02162+\begin{bmatrix}1.152&amp;-9.514e-21\end{bmatrix}X_t^1+\begin{bmatrix}11.88&amp;-2.2e-19\end{bmatrix}X_t^2+X^{1T}_{t}\begin{bmatrix}-52.61&amp;4.876e-18\\-3.64e-18&amp;-9.04e-38\end{bmatrix}X^1_{t}\end{split}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Log capital growth process first order approximation results</span>
<span class="n">disp</span><span class="p">(</span><span class="n">ModelSol</span><span class="p">[</span><span class="s1">'X1_tp1'</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="s1">'</span><span class="se">\\</span><span class="s1">log</span><span class="se">\\</span><span class="s1">frac{K_{t+1}^1}{K_t^1}'</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \log\frac{K_{t+1}^1}{K_t^1}=\begin{bmatrix}0.9861&amp;-0\end{bmatrix}X_t^1+\begin{bmatrix}0.00011&amp;0.00025\end{bmatrix}W_{t+1}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Log capital growth process second order approximation results</span>
<span class="n">disp</span><span class="p">(</span><span class="n">ModelSol</span><span class="p">[</span><span class="s1">'X2_tp1'</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="s1">'</span><span class="se">\\</span><span class="s1">log</span><span class="se">\\</span><span class="s1">frac{K_{t+1}^2}{K_t^2}'</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \log\frac{K_{t+1}^2}{K_t^2}=\begin{bmatrix}0.9861&amp;-0\end{bmatrix}X_t^2\]</div>
</div>
</div>
</section>
<section id="approximate-variables-a-class-anchor-id-s1-8-a">
<h2 id="approximate-variables-a-class-anchor-id-s1-8-a">1.8 Approximate Variables <a class="anchor" id="s1-8"></a><a class="headerlink" href="#approximate-variables-a-class-anchor-id-s1-8-a" title="Permalink to this heading">¶</a></h2>
<p>If some variables can be computed using solved model variables, we can write a function to specify how to approximate, and then use the method <code class="docutils literal notranslate"><span class="pre">ModelSolution.approximate</span></code> to compute the approximation of these variables using model solutions. The below example computes the approximation of log investment growth process.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">gi_tp1_approx</span><span class="p">(</span><span class="n">Var_t</span><span class="p">,</span> <span class="n">Var_tp1</span><span class="p">,</span> <span class="n">W_tp1</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>

    <span class="c1"># Parameters for the model</span>
    <span class="n">γ</span><span class="p">,</span> <span class="n">β</span><span class="p">,</span> <span class="n">ρ</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">θ_1</span><span class="p">,</span> <span class="n">θ_2</span><span class="p">,</span> <span class="n">α_k</span><span class="p">,</span> <span class="n">σ_k</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">args</span>

    <span class="c1"># Variables: (q_t, q_tp1 is excluded when using the method in `ModelSolution`)</span>
    <span class="n">cmk_t</span><span class="p">,</span> <span class="n">imk_t</span><span class="p">,</span> <span class="n">mkmc_t</span><span class="p">,</span> <span class="n">Z_t</span><span class="p">,</span> <span class="n">gk_t</span> <span class="o">=</span> <span class="n">Var_t</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
    <span class="n">cmk_tp1</span><span class="p">,</span> <span class="n">imk_tp1</span><span class="p">,</span> <span class="n">mkmc_tp1</span><span class="p">,</span> <span class="n">Z_tp1</span><span class="p">,</span> <span class="n">gk_tp1</span> <span class="o">=</span> <span class="n">Var_tp1</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
    
    <span class="n">gi_tp1</span> <span class="o">=</span> <span class="n">imk_tp1</span> <span class="o">+</span> <span class="n">gk_tp1</span> <span class="o">-</span><span class="n">imk_t</span>
    
    <span class="k">return</span> <span class="n">gi_tp1</span>

<span class="n">n_J</span><span class="p">,</span> <span class="n">n_X</span><span class="p">,</span> <span class="n">n_W</span> <span class="o">=</span> <span class="n">var_shape</span>
<span class="n">gi_tp1_list</span> <span class="o">=</span> <span class="n">ModelSol</span><span class="o">.</span><span class="n">approximate</span><span class="p">(</span><span class="n">gi_tp1_approx</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
<span class="n">gi_tp1</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'gi_tp1'</span><span class="p">:</span><span class="n">gi_tp1_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>\
        <span class="s1">'gi0_tp1'</span><span class="p">:</span><span class="n">gi_tp1_list</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>\
        <span class="s1">'gi1_tp1'</span><span class="p">:</span><span class="n">gi_tp1_list</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>\
        <span class="s1">'gi2_tp1'</span><span class="p">:</span><span class="n">gi_tp1_list</span><span class="p">[</span><span class="mi">3</span><span class="p">]}</span>
<span class="n">gi_tp1</span><span class="p">[</span><span class="s1">'gi1_tp1'</span><span class="p">]</span><span class="o">.</span><span class="n">coeffs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{'c': array([[0.00030791]]),
 'w': array([[ 0.00415864, -0.00138945]]),
 'x': array([[ 1.03727514, -0.        ]])}
</pre></div>
</div>
</div>
</div>
</section>
<section id="model-simulations-a-class-anchor-id-s1-9-a">
<h2 id="model-simulations-a-class-anchor-id-s1-9-a">1.9 Model Simulations <a class="anchor" id="s1-9"></a><a class="headerlink" href="#model-simulations-a-class-anchor-id-s1-9-a" title="Permalink to this heading">¶</a></h2>
<p>Given a series of shock processes, we can simulate variables using the <code class="docutils literal notranslate"><span class="pre">ModelSolution.simulate</span></code> method. The below example simulates all jump and state variables with 400 periods i.i.d standard multivariate normal shocks.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ws</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_W</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n_W</span><span class="p">),</span><span class="n">size</span> <span class="o">=</span> <span class="mi">400</span><span class="p">)</span>
<span class="n">JX_sim</span> <span class="o">=</span> <span class="n">ModelSol</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">Ws</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="shock-elasticities-and-irf-a-class-anchor-id-s1-10-a">
<h2 id="shock-elasticities-and-irf-a-class-anchor-id-s1-10-a">1.10 Shock Elasticities and IRF <a class="anchor" id="s1-10"></a><a class="headerlink" href="#shock-elasticities-and-irf-a-class-anchor-id-s1-10-a" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">ModelSolution</span></code> has a method <code class="docutils literal notranslate"><span class="pre">elasticities</span></code> to compute the shock elasticities of all jump and state variables by defining a <code class="docutils literal notranslate"><span class="pre">log_SDF_ex</span></code> function, which states the log stochastic discount factor exclusive of the change of measure <span class="math notranslate nohighlight">\({N}^*_{t+1}\)</span> and variable <span class="math notranslate nohighlight">\(Q_{t+1}^*\)</span>. Shock elasticities are great tools for nonlinear impulsive response analyses, and in linear models, the shock elasticities correspond to the traditional IRF.</p>
<p><code class="docutils literal notranslate"><span class="pre">ModelSolution</span></code> also has a method <code class="docutils literal notranslate"><span class="pre">IRF</span></code> to compute the traditional IRF of all jump and state variables. Below we calculate the IRF of all variables with respect to the first shock for 400 periods.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">log_SDF_ex</span><span class="p">(</span><span class="n">Var_t</span><span class="p">,</span> <span class="n">Var_tp1</span><span class="p">,</span> <span class="n">W_tp1</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>

    <span class="c1"># Log stochastic discount factor exclusive of the change of measure N and Q.</span>

    <span class="c1"># Parameters for the model </span>
    <span class="n">γ</span><span class="p">,</span> <span class="n">β</span><span class="p">,</span> <span class="n">ρ</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">θ_1</span><span class="p">,</span> <span class="n">θ_2</span><span class="p">,</span> <span class="n">α_k</span><span class="p">,</span> <span class="n">σ_k</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">args</span>

    <span class="c1"># Variables: (q_t, q_tp1 is excluded when using the method in `ModelSolution`) </span>
    <span class="n">cmk_t</span><span class="p">,</span> <span class="n">imk_t</span><span class="p">,</span> <span class="n">mkmc_t</span><span class="p">,</span> <span class="n">Z_t</span><span class="p">,</span> <span class="n">gk_t</span> <span class="o">=</span> <span class="n">Var_t</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
    <span class="n">cmk_tp1</span><span class="p">,</span> <span class="n">imk_tp1</span><span class="p">,</span> <span class="n">mkmc_tp1</span><span class="p">,</span> <span class="n">Z_tp1</span><span class="p">,</span> <span class="n">gk_tp1</span> <span class="o">=</span> <span class="n">Var_tp1</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
    
    <span class="n">sdf_ex</span> <span class="o">=</span> <span class="n">anp</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">β</span><span class="p">)</span> <span class="o">-</span> <span class="n">ρ</span><span class="o">*</span><span class="p">(</span><span class="n">cmk_tp1</span><span class="o">+</span><span class="n">gk_tp1</span><span class="o">-</span><span class="n">cmk_t</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">sdf_ex</span>

<span class="n">expo_elas</span><span class="p">,</span> <span class="n">price_elas</span> <span class="o">=</span> <span class="n">ModelSol</span><span class="o">.</span><span class="n">elasticities</span><span class="p">(</span><span class="n">log_SDF_ex</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">shock</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">states</span><span class="p">,</span> <span class="n">controls</span> <span class="o">=</span> <span class="n">ModelSol</span><span class="o">.</span><span class="n">IRF</span><span class="p">(</span><span class="n">T</span> <span class="o">=</span> <span class="mi">400</span><span class="p">,</span> <span class="n">shock</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>OMP: Info #271: omp_set_nested routine deprecated, please use omp_set_max_active_levels instead.
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="examples-to-use-linquadvar-in-computation-a-class-anchor-id-s2-a">
<h1 id="examples-to-use-linquadvar-in-computation-a-class-anchor-id-s2-a">2 Examples to use <code class="docutils literal notranslate"><span class="pre">LinQuadVar</span></code> in Computation <a class="anchor" id="s2"></a><a class="headerlink" href="#examples-to-use-linquadvar-in-computation-a-class-anchor-id-s2-a" title="Permalink to this heading">¶</a></h1>
<section id="define-a-linquadvar-a-class-anchor-id-s2-1-a">
<h2 id="define-a-linquadvar-a-class-anchor-id-s2-1-a">2.1 Define a <code class="docutils literal notranslate"><span class="pre">LinQuadVar</span></code> <a class="anchor" id="s2-1"></a><a class="headerlink" href="#define-a-linquadvar-a-class-anchor-id-s2-1-a" title="Permalink to this heading">¶</a></h2>
<p>Below we extract the steady states for the state evolution processes from the previous model solution, and construct it as a 2-dimensional LinQuadVar.</p>
<p>See <a class="reference external" href="https://github.com/lphansen/RiskUncertaintyValue/blob/main/src/lin_quad.py">src/lin_quad.py</a> for source code of <code class="docutils literal notranslate"><span class="pre">LinQuad</span></code> definition.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_J</span><span class="p">,</span> <span class="n">n_X</span><span class="p">,</span> <span class="n">n_W</span> <span class="o">=</span> <span class="n">ModelSol</span><span class="p">[</span><span class="s1">'var_shape'</span><span class="p">]</span>
<span class="n">X0_tp1</span> <span class="o">=</span> <span class="n">LinQuadVar</span><span class="p">({</span><span class="s1">'c'</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">ModelSol</span><span class="p">[</span><span class="s1">'ss'</span><span class="p">][</span><span class="mi">1</span><span class="p">]],[</span><span class="n">ModelSol</span><span class="p">[</span><span class="s1">'ss'</span><span class="p">][</span><span class="mi">2</span><span class="p">]]])},</span> <span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_X</span><span class="p">,</span> <span class="n">n_W</span><span class="p">))</span>
<span class="n">X0_tp1</span><span class="o">.</span><span class="n">coeffs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{'c': array([[-3.93129532],
        [ 1.00634613]])}
</pre></div>
</div>
</div>
</div>
</section>
<section id="linquadvar-operations-a-class-anchor-id-s2-2-a">
<h2 id="linquadvar-operations-a-class-anchor-id-s2-2-a">2.2 <code class="docutils literal notranslate"><span class="pre">LinQuadVar</span></code> Operations <a class="anchor" id="s2-2"></a><a class="headerlink" href="#linquadvar-operations-a-class-anchor-id-s2-2-a" title="Permalink to this heading">¶</a></h2>
<p>Below show two ways to add two LinQuads, we use the zeroth order, first order, second order approximation results to construct the approximation for the growth process or both state evolution processes.
See <a class="reference external" href="https://github.com/lphansen/RiskUncertaintyValue/blob/main/src/lin_quad_util.py">src/lin_quad_util.py</a> for source code of <code class="docutils literal notranslate"><span class="pre">LinQuad</span></code> operations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gk_tp1</span> <span class="o">=</span> <span class="n">X0_tp1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">ModelSol</span><span class="p">[</span><span class="s1">'X1_tp1'</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>  <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">ModelSol</span><span class="p">[</span><span class="s1">'X2_tp1'</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> 
<span class="n">disp</span><span class="p">(</span><span class="n">gk_tp1</span><span class="p">,</span><span class="s1">'</span><span class="se">\\</span><span class="s1">log</span><span class="se">\\</span><span class="s1">frac{K_{t+1}}</span><span class="si">{K_t}</span><span class="s1">'</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \log\frac{K_{t+1}}{K_t}=-3.931+\begin{bmatrix}0.9861&amp;0\end{bmatrix}X_t^1+\begin{bmatrix}0.00011&amp;0.00025\end{bmatrix}W_{t+1}+\begin{bmatrix}0.493&amp;0\end{bmatrix}X_t^2\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lq_sum</span><span class="p">([</span><span class="n">X0_tp1</span><span class="p">,</span> <span class="n">ModelSol</span><span class="p">[</span><span class="s1">'X1_tp1'</span><span class="p">],</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">ModelSol</span><span class="p">[</span><span class="s1">'X2_tp1'</span><span class="p">]])</span><span class="o">.</span><span class="n">coeffs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{'c': array([[-3.93129532],
        [ 1.00667219]]),
 'w': array([[0.00011, 0.00025],
        [0.00477, 0.     ]]),
 'x': array([[0.98609754, 0.        ],
        [0.9628084 , 0.        ]]),
 'xx': array([[ 0.        ,  0.        ,  0.        ,  0.        ],
        [-0.21924476, -0.        ,  0.        ,  0.        ]]),
 'x2': array([[0.49304877, 0.        ],
        [0.48000401, 0.        ]])}
</pre></div>
</div>
</div>
</div>
</section>
<section id="linquadvar-split-and-concat-a-class-anchor-id-s2-3-a">
<h2 id="linquadvar-split-and-concat-a-class-anchor-id-s2-3-a">2.3 <code class="docutils literal notranslate"><span class="pre">LinQuadVar</span></code> Split and Concat <a class="anchor" id="s2-3"></a><a class="headerlink" href="#linquadvar-split-and-concat-a-class-anchor-id-s2-3-a" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">split</span></code> breaks multiple dimensional LinQuad into one-dimensional LinQuads, while <code class="docutils literal notranslate"><span class="pre">concat</span></code> does the inverse operation</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gk_tp1</span><span class="p">,</span> <span class="n">Z_tp1</span> <span class="o">=</span> <span class="n">ModelSol</span><span class="p">[</span><span class="s1">'X1_tp1'</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="n">concat</span><span class="p">([</span><span class="n">gk_tp1</span><span class="p">,</span> <span class="n">Z_tp1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;lin_quad.LinQuadVar at 0x7f9ad3e40b80&gt;
</pre></div>
</div>
</div>
</div>
</section>
<section id="evaluate-a-linquadvar-a-class-anchor-id-s2-4-a">
<h2 id="evaluate-a-linquadvar-a-class-anchor-id-s2-4-a">2.4 Evaluate a <code class="docutils literal notranslate"><span class="pre">LinQuadVar</span></code> <a class="anchor" id="s2-4"></a><a class="headerlink" href="#evaluate-a-linquadvar-a-class-anchor-id-s2-4-a" title="Permalink to this heading">¶</a></h2>
<p>Given specific values for <span class="math notranslate nohighlight">\(X_{t}\)</span>, <span class="math notranslate nohighlight">\(W_{t+1}\)</span>, we can evaluate a <code class="docutils literal notranslate"><span class="pre">LinQuadVar</span></code>. Below evaluates all variables at first and second order expansion states equal to 0, together with a multivariate random normal shock.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">n_X</span> <span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">n_X</span> <span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_W</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n_W</span><span class="p">),</span><span class="n">size</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">ModelSol</span><span class="p">[</span><span class="s1">'JX_tp1'</span><span class="p">](</span><span class="o">*</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">w</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-4.79592804],
       [-3.88503366],
       [ 1.03543888],
       [-0.00025322],
       [-0.00712572]])
</pre></div>
</div>
</div>
</div>
</section>
<section id="adjust-conditional-information-time-a-class-anchor-id-s2-5-a">
<h2 id="adjust-conditional-information-time-a-class-anchor-id-s2-5-a">2.5 Adjust Conditional Information Time <a class="anchor" id="s2-5"></a><a class="headerlink" href="#adjust-conditional-information-time-a-class-anchor-id-s2-5-a" title="Permalink to this heading">¶</a></h2>
<p>Since some <code class="docutils literal notranslate"><span class="pre">LinQuadVar</span></code> (e.g. solved jump variables) are expressed as a function of time <span class="math notranslate nohighlight">\(t\)</span> state variables without shocks, when we would like to compute its next period expression, <span class="math notranslate nohighlight">\(t+1\)</span>, with shocks, but still as a function of time <span class="math notranslate nohighlight">\(t\)</span> state variables, we can use function <code class="docutils literal notranslate"><span class="pre">next_period</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmk1_tp1</span> <span class="o">=</span> <span class="n">next_period</span><span class="p">(</span><span class="n">ModelSol</span><span class="p">[</span><span class="s1">'J1_t'</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">ModelSol</span><span class="p">[</span><span class="s1">'X1_tp1'</span><span class="p">])</span>
<span class="n">disp</span><span class="p">(</span><span class="n">cmk1_tp1</span><span class="p">,</span> <span class="s1">'</span><span class="se">\\</span><span class="s1">log</span><span class="se">\\</span><span class="s1">frac{C_{t+1}^1}{K_{t+1}^1}'</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \log\frac{C_{t+1}^1}{K_{t+1}^1}=-0.09143+\begin{bmatrix}11.71&amp;-1.63e-40\end{bmatrix}X_t^1+\begin{bmatrix}0.001306&amp;0.002969\end{bmatrix}W_{t+1}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmk2_tp1</span> <span class="o">=</span> <span class="n">next_period</span><span class="p">(</span><span class="n">ModelSol</span><span class="p">[</span><span class="s1">'J2_t'</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">ModelSol</span><span class="p">[</span><span class="s1">'X1_tp1'</span><span class="p">],</span> <span class="n">ModelSol</span><span class="p">[</span><span class="s1">'X2_tp1'</span><span class="p">])</span>
<span class="n">disp</span><span class="p">(</span><span class="n">cmk2_tp1</span><span class="p">,</span> <span class="s1">'</span><span class="se">\\</span><span class="s1">log</span><span class="se">\\</span><span class="s1">frac{C_{t+1}^2}{K_{t+1}^2}'</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \log\frac{C_{t+1}^2}{K_{t+1}^2}=-0.02162+\begin{bmatrix}1.136&amp;2.455e-41\end{bmatrix}X_t^1+\begin{bmatrix}0.0001267&amp;0.000288\end{bmatrix}W_{t+1}+\begin{bmatrix}11.71&amp;-1.63e-40\end{bmatrix}X_t^2+X^{1T}_{t}\begin{bmatrix}-51.15&amp;4.666e-39\\-7.867e-39&amp;-2.048e-59\end{bmatrix}X^1_{t}+X^{1T}_{t}\begin{bmatrix}-0.01141&amp;-0.02594\\1.007e-43&amp;2.289e-43\end{bmatrix}W_{t+1}+W_{t+1}^{T}\begin{bmatrix}-6.365e-07&amp;-1.447e-06\\-1.447e-06&amp;-3.288e-06\end{bmatrix}W_{t+1}\end{split}\]</div>
</div>
</div>
</section>
<section id="compute-the-expectation-of-time-t-1-linquadvar-a-class-anchor-id-s2-6-a">
<h2 id="compute-the-expectation-of-time-t-1-linquadvar-a-class-anchor-id-s2-6-a">2.6 Compute the Expectation of time <span class="math notranslate nohighlight">\(t+1\)</span> <code class="docutils literal notranslate"><span class="pre">LinQuadVar</span></code> <a class="anchor" id="s2-6"></a><a class="headerlink" href="#compute-the-expectation-of-time-t-1-linquadvar-a-class-anchor-id-s2-6-a" title="Permalink to this heading">¶</a></h2>
<p>Suppose the distribution of shock has a constant mean and variance (not state dependent), we can use <code class="docutils literal notranslate"><span class="pre">E</span></code> to compute the expectation of time <span class="math notranslate nohighlight">\(t+1\)</span> <code class="docutils literal notranslate"><span class="pre">LinQuadVar</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E_w</span> <span class="o">=</span> <span class="n">ModelSol</span><span class="p">[</span><span class="s1">'util_sol'</span><span class="p">][</span><span class="s1">'μ_0'</span><span class="p">]</span>
<span class="n">cov_w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n_W</span><span class="p">)</span>
<span class="n">E_ww</span> <span class="o">=</span> <span class="n">cal_E_ww</span><span class="p">(</span><span class="n">E_w</span><span class="p">,</span> <span class="n">cov_w</span><span class="p">)</span>
<span class="n">E_cmk2_tp1</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">cmk2_tp1</span><span class="p">,</span> <span class="n">E_w</span><span class="p">,</span> <span class="n">E_ww</span><span class="p">)</span>
<span class="n">disp</span><span class="p">(</span><span class="n">E_cmk2_tp1</span><span class="p">,</span> <span class="s1">'\mathbb</span><span class="si">{E}</span><span class="s1">[</span><span class="se">\\</span><span class="s1">log</span><span class="se">\\</span><span class="s1">frac{C_{t+1}^2}{K_{t+1}^2}|\mathfrak</span><span class="si">{F_t}</span><span class="s1">]'</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \mathbb{E}[\log\frac{C_{t+1}^2}{K_{t+1}^2}|\mathfrak{F_t}]=-0.02167+\begin{bmatrix}1.14&amp;2.451e-41\end{bmatrix}X_t^1+\begin{bmatrix}11.71&amp;-1.63e-40\end{bmatrix}X_t^2+X^{1T}_{t}\begin{bmatrix}-51.15&amp;4.666e-39\\-7.867e-39&amp;-2.048e-59\end{bmatrix}X^1_{t}\end{split}\]</div>
</div>
</div>
<p>Suppose the distribution of shock has a state-dependent mean and variance (implied by <span class="math notranslate nohighlight">\(\tilde{N}_{t+1}\)</span> shown in the notes), we can use <code class="docutils literal notranslate"><span class="pre">E_N_tp1</span></code> and <code class="docutils literal notranslate"><span class="pre">N_tilde_measure</span></code> to compute the expectation of time <span class="math notranslate nohighlight">\(t+1\)</span> <code class="docutils literal notranslate"><span class="pre">LinQuadVar</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N_cm</span> <span class="o">=</span> <span class="n">N_tilde_measure</span><span class="p">(</span><span class="n">ModelSol</span><span class="p">[</span><span class="s1">'util_sol'</span><span class="p">][</span><span class="s1">'log_N_tilde'</span><span class="p">],(</span><span class="mi">1</span><span class="p">,</span><span class="n">n_X</span><span class="p">,</span><span class="n">n_W</span><span class="p">))</span>
<span class="n">E_cmk2_tp1_tilde</span> <span class="o">=</span> <span class="n">E_N_tp1</span><span class="p">(</span><span class="n">cmk2_tp1</span><span class="p">,</span> <span class="n">N_cm</span><span class="p">)</span>
<span class="n">disp</span><span class="p">(</span><span class="n">E_cmk2_tp1_tilde</span><span class="p">,</span> <span class="s1">'\mathbb{</span><span class="se">\\</span><span class="s1">tilde</span><span class="si">{E}</span><span class="s1">}[</span><span class="se">\\</span><span class="s1">log</span><span class="se">\\</span><span class="s1">frac{C_{t+1}^2}{K_{t+1}^2}|\mathfrak</span><span class="si">{F_t}</span><span class="s1">]'</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \mathbb{\tilde{E}}[\log\frac{C_{t+1}^2}{K_{t+1}^2}|\mathfrak{F_t}]=-0.02167+\begin{bmatrix}1.141&amp;2.451e-41\end{bmatrix}X_t^1+\begin{bmatrix}11.71&amp;-1.63e-40\end{bmatrix}X_t^2+X^{1T}_{t}\begin{bmatrix}-51.16&amp;4.666e-39\\-7.867e-39&amp;-2.048e-59\end{bmatrix}X^1_{t}\end{split}\]</div>
</div>
</div>
</section>
</section>
<script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./discrete_local_approximation"
        },
        predefinedOutput: true
    }
    </script>
<script>kernelName = 'python3'</script>

          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="../intro.html" title="Quant Macro Finance"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> Quant Macro Finance </span>
              </div>
            </a>
          
          
            <a href="uncertainexpansion.html" title="Uncertain Expansion Methods"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> Uncertain Expansion Methods </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2022.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 5.0.2.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>